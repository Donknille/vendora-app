import { createContext, useContext } from "react";
import { Platform, NativeModules } from "react-native";

export type Language = "de" | "en";

const translations = {
  en: {
    dashboard: {
      overview: "Overview",
      dashboard: "Dashboard",
      revenue: "Revenue",
      expenses: "Expenses",
      netProfit: "Net Profit",
      monthlyPerformance: "Monthly Performance",
      openOrders: "Open Orders",
      paidOrders: "Paid Orders",
      markets: "Markets",
      allYears: "All",
    },
    orders: {
      title: "Orders",
      noOrders: "No orders yet",
      noOrdersSub: "Create your first order to start tracking sales",
      newOrder: "New Order",
      invoice: "Invoice",
      customer: "Customer",
      customerName: "Customer name",
      email: "Email (optional)",
      address: "Address (optional)",
      items: "Items",
      itemName: "Item name",
      qty: "Qty",
      price: "Price",
      notes: "Notes",
      additionalNotes: "Additional notes (optional)",
      total: "Total",
      createOrder: "Create Order",
      orderDetails: "Order Details",
      updateStatus: "Update Status",
      deleteOrder: "Delete Order",
      deleteConfirm: "Are you sure you want to delete this order?",
      deleteCancel: "Cancel",
      deleteAction: "Delete",
      changeStatus: "Change Status",
      changeStatusConfirm: "Set order to",
      confirm: "Confirm",
      missingInfo: "Missing Info",
      enterCustomerName: "Please enter a customer name.",
      fillItemNames: "Please fill in all item names.",
      item: "item",
      items_plural: "items",
      cannotUndo: "This cannot be undone.",
      createInvoice: "Create Invoice",
      invoiceTitle: "INVOICE",
      invoiceFrom: "From",
      invoiceTo: "To",
      invoiceDate: "Date",
      invoiceNumber: "Invoice No.",
      invoiceItem: "Item",
      invoiceQty: "Qty",
      invoiceUnitPrice: "Unit Price",
      invoiceAmount: "Amount",
      invoiceSubtotal: "Subtotal",
      invoiceTotal: "Total",
      invoiceNotes: "Notes",
      invoiceGenerated: "Invoice generated successfully.",
      invoiceError: "Could not generate invoice.",
      shareInvoice: "Share Invoice",
      invoiceThankYou: "Thank you for your purchase!",
      orderDate: "Date",
      orderDatePlaceholder: "Order date",
    },
    markets: {
      title: "Markets",
      noMarkets: "No markets yet",
      noMarketsSub: "Add your first market event to track sales",
      newMarket: "New Market",
      eventDetails: "Event Details",
      marketName: "Market name",
      location: "Location (optional)",
      costs: "Costs",
      standFee: "Stand Fee",
      travelCost: "Travel Cost",
      notes: "Notes",
      additionalNotes: "Additional notes (optional)",
      createMarket: "Create Market",
      marketDetails: "Market Details",
      sales: "Sales",
      profit: "Profit",
      costBreakdown: "Cost Breakdown",
      travel: "Travel",
      noSales: "No sales recorded yet. Use the + button to add quick sales.",
      itemDescription: "Item description",
      deleteSale: "Delete Sale",
      removeSale: "Remove this sale?",
      deleteMarket: "Delete Market",
      deleteMarketConfirm: "This will also remove all associated sales.",
      deleteCancel: "Cancel",
      deleteAction: "Delete",
    },
    expenses: {
      title: "Expenses",
      noExpenses: "No expenses yet",
      noExpensesSub: "Track your business expenses to see accurate profit",
      newExpense: "New Expense",
      description: "Description",
      whatSpent: "What did you spend on?",
      amount: "Amount",
      category: "Category",
      addExpense: "Add Expense",
      expenseDate: "Date",
      expenseDatePlaceholder: "Expense date",
      deleteExpense: "Delete Expense",
      areYouSure: "Are you sure?",
      cancel: "Cancel",
      delete: "Delete",
      total: "Total",
      categories: {
        Materials: "Materials",
        Shipping: "Shipping",
        Subscriptions: "Subscriptions",
        Tools: "Tools",
        Marketing: "Marketing",
        Packaging: "Packaging",
        Other: "Other",
      },
    },
    settings: {
      title: "Settings",
      companyProfile: "Company Profile",
      companyName: "Company Name",
      address: "Address",
      email: "Email",
      phone: "Phone",
      taxNote: "Tax Note (shown on invoices)",
      taxNotePlaceholder: "e.g. As per \u00A7 19 UStG, no VAT is charged.",
      notSet: "Not set",
      dataBackup: "Data & Backup",
      exportBackup: "Export Backup",
      restoreBackup: "Restore from Backup",
      factoryReset: "Factory Reset",
      privacy: "Privacy",
      privacyText: "Vendora stores all data locally on your device. No tracking, analytics, or cloud dependencies. You own 100% of your data.",
      exportComplete: "Export Complete",
      exportSuccess: "Your data has been exported successfully.",
      exportFailed: "Export Failed",
      exportError: "Could not export data. Please try again.",
      importComplete: "Import Complete",
      importSuccess: "Your data has been restored successfully.",
      importFailed: "Import Failed",
      importError: "Could not read the backup file. Please try again.",
      resetTitle: "Factory Reset",
      resetMessage: "This will permanently delete all your data. This action cannot be undone.",
      resetCancel: "Cancel",
      resetAction: "Delete Everything",
      resetComplete: "Reset Complete",
      resetSuccess: "All data has been wiped.",
      language: "Language",
      appearance: "Appearance",
      dark: "Dark",
      light: "Light",
      system: "System",
    },
    tabs: {
      dashboard: "Dashboard",
      orders: "Orders",
      markets: "Markets",
      expenses: "Expenses",
      settings: "Settings",
    },
    common: {
      loading: "Loading...",
      cancel: "Cancel",
      delete: "Delete",
      confirm: "Confirm",
      save: "Save",
    },
    months: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  },
  de: {
    dashboard: {
      overview: "\u00DCbersicht",
      dashboard: "Dashboard",
      revenue: "Umsatz",
      expenses: "Ausgaben",
      netProfit: "Nettogewinn",
      monthlyPerformance: "Monatliche Entwicklung",
      openOrders: "Offene Auftr\u00E4ge",
      paidOrders: "Bezahlte Auftr\u00E4ge",
      markets: "M\u00E4rkte",
      allYears: "Alle",
    },
    orders: {
      title: "Auftr\u00E4ge",
      noOrders: "Noch keine Auftr\u00E4ge",
      noOrdersSub: "Erstelle deinen ersten Auftrag, um Verk\u00E4ufe zu verfolgen",
      newOrder: "Neuer Auftrag",
      invoice: "Rechnung",
      customer: "Kunde",
      customerName: "Kundenname",
      email: "E-Mail (optional)",
      address: "Adresse (optional)",
      items: "Artikel",
      itemName: "Artikelname",
      qty: "Anz.",
      price: "Preis",
      notes: "Notizen",
      additionalNotes: "Zus\u00E4tzliche Notizen (optional)",
      total: "Gesamt",
      createOrder: "Auftrag erstellen",
      orderDetails: "Auftragsdetails",
      updateStatus: "Status \u00E4ndern",
      deleteOrder: "Auftrag l\u00F6schen",
      deleteConfirm: "M\u00F6chtest du diesen Auftrag wirklich l\u00F6schen?",
      deleteCancel: "Abbrechen",
      deleteAction: "L\u00F6schen",
      changeStatus: "Status \u00E4ndern",
      changeStatusConfirm: "Status setzen auf",
      confirm: "Best\u00E4tigen",
      missingInfo: "Fehlende Angaben",
      enterCustomerName: "Bitte gib einen Kundennamen ein.",
      fillItemNames: "Bitte f\u00FClle alle Artikelnamen aus.",
      item: "Artikel",
      items_plural: "Artikel",
      cannotUndo: "Dies kann nicht r\u00FCckg\u00E4ngig gemacht werden.",
      createInvoice: "Rechnung erstellen",
      invoiceTitle: "RECHNUNG",
      invoiceFrom: "Von",
      invoiceTo: "An",
      invoiceDate: "Datum",
      invoiceNumber: "Rechnungsnr.",
      invoiceItem: "Artikel",
      invoiceQty: "Anz.",
      invoiceUnitPrice: "Einzelpreis",
      invoiceAmount: "Betrag",
      invoiceSubtotal: "Zwischensumme",
      invoiceTotal: "Gesamtbetrag",
      invoiceNotes: "Anmerkungen",
      invoiceGenerated: "Rechnung erfolgreich erstellt.",
      invoiceError: "Rechnung konnte nicht erstellt werden.",
      shareInvoice: "Rechnung teilen",
      invoiceThankYou: "Vielen Dank f\u00FCr Ihren Einkauf!",
      orderDate: "Datum",
      orderDatePlaceholder: "Auftragsdatum",
    },
    markets: {
      title: "M\u00E4rkte",
      noMarkets: "Noch keine M\u00E4rkte",
      noMarketsSub: "F\u00FCge dein erstes Marktevent hinzu, um Verk\u00E4ufe zu verfolgen",
      newMarket: "Neuer Markt",
      eventDetails: "Veranstaltungsdetails",
      marketName: "Marktname",
      location: "Ort (optional)",
      costs: "Kosten",
      standFee: "Standgeb\u00FChr",
      travelCost: "Fahrtkosten",
      notes: "Notizen",
      additionalNotes: "Zus\u00E4tzliche Notizen (optional)",
      createMarket: "Markt erstellen",
      marketDetails: "Marktdetails",
      sales: "Verk\u00E4ufe",
      profit: "Gewinn",
      costBreakdown: "Kosten\u00FCbersicht",
      travel: "Fahrt",
      noSales: "Noch keine Verk\u00E4ufe. Verwende den + Button, um schnell Verk\u00E4ufe hinzuzuf\u00FCgen.",
      itemDescription: "Artikelbeschreibung",
      deleteSale: "Verkauf l\u00F6schen",
      removeSale: "Diesen Verkauf entfernen?",
      deleteMarket: "Markt l\u00F6schen",
      deleteMarketConfirm: "Dadurch werden auch alle zugeh\u00F6rigen Verk\u00E4ufe entfernt.",
      deleteCancel: "Abbrechen",
      deleteAction: "L\u00F6schen",
    },
    expenses: {
      title: "Ausgaben",
      noExpenses: "Noch keine Ausgaben",
      noExpensesSub: "Verfolge deine Gesch\u00E4ftsausgaben f\u00FCr genauen Gewinn",
      newExpense: "Neue Ausgabe",
      description: "Beschreibung",
      whatSpent: "Wof\u00FCr hast du ausgegeben?",
      amount: "Betrag",
      category: "Kategorie",
      addExpense: "Ausgabe hinzuf\u00FCgen",
      expenseDate: "Datum",
      expenseDatePlaceholder: "Ausgabedatum",
      deleteExpense: "Ausgabe l\u00F6schen",
      areYouSure: "Bist du sicher?",
      cancel: "Abbrechen",
      delete: "L\u00F6schen",
      total: "Gesamt",
      categories: {
        Materials: "Materialien",
        Shipping: "Versand",
        Subscriptions: "Abonnements",
        Tools: "Werkzeuge",
        Marketing: "Marketing",
        Packaging: "Verpackung",
        Other: "Sonstiges",
      },
    },
    settings: {
      title: "Einstellungen",
      companyProfile: "Firmenprofil",
      companyName: "Firmenname",
      address: "Adresse",
      email: "E-Mail",
      phone: "Telefon",
      taxNote: "Steuerhinweis (auf Rechnungen)",
      taxNotePlaceholder: "z.B. Gem. \u00A7 19 UStG wird keine Umsatzsteuer berechnet.",
      notSet: "Nicht gesetzt",
      dataBackup: "Daten & Sicherung",
      exportBackup: "Backup exportieren",
      restoreBackup: "Aus Backup wiederherstellen",
      factoryReset: "Werkseinstellungen",
      privacy: "Datenschutz",
      privacyText: "Vendora speichert alle Daten lokal auf deinem Ger\u00E4t. Kein Tracking, keine Analysen, keine Cloud-Abh\u00E4ngigkeiten. Du besitzt 100% deiner Daten.",
      exportComplete: "Export abgeschlossen",
      exportSuccess: "Deine Daten wurden erfolgreich exportiert.",
      exportFailed: "Export fehlgeschlagen",
      exportError: "Daten konnten nicht exportiert werden. Bitte versuche es erneut.",
      importComplete: "Import abgeschlossen",
      importSuccess: "Deine Daten wurden erfolgreich wiederhergestellt.",
      importFailed: "Import fehlgeschlagen",
      importError: "Die Backup-Datei konnte nicht gelesen werden. Bitte versuche es erneut.",
      resetTitle: "Werkseinstellungen",
      resetMessage: "Dadurch werden alle Daten dauerhaft gel\u00F6scht. Diese Aktion kann nicht r\u00FCckg\u00E4ngig gemacht werden.",
      resetCancel: "Abbrechen",
      resetAction: "Alles l\u00F6schen",
      resetComplete: "Zur\u00FCcksetzen abgeschlossen",
      resetSuccess: "Alle Daten wurden gel\u00F6scht.",
      language: "Sprache",
      appearance: "Darstellung",
      dark: "Dunkel",
      light: "Hell",
      system: "System",
    },
    tabs: {
      dashboard: "Dashboard",
      orders: "Auftr\u00E4ge",
      markets: "M\u00E4rkte",
      expenses: "Ausgaben",
      settings: "Einstellungen",
    },
    common: {
      loading: "Laden...",
      cancel: "Abbrechen",
      delete: "L\u00F6schen",
      confirm: "Best\u00E4tigen",
      save: "Speichern",
    },
    months: ["Jan", "Feb", "M\u00E4r", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
  },
} as const;

export type Translations = typeof translations.en;

export function getDeviceLanguage(): Language {
  try {
    let locale = "en";
    if (Platform.OS === "ios") {
      locale =
        NativeModules.SettingsManager?.settings?.AppleLocale ||
        NativeModules.SettingsManager?.settings?.AppleLanguages?.[0] ||
        "en";
    } else if (Platform.OS === "android") {
      locale = NativeModules.I18nManager?.localeIdentifier || "en";
    } else {
      locale = typeof navigator !== "undefined" ? navigator.language || "en" : "en";
    }
    return locale.startsWith("de") ? "de" : "en";
  } catch {
    return "en";
  }
}

export function getTranslations(lang: Language): Translations {
  return translations[lang];
}

export { translations };
